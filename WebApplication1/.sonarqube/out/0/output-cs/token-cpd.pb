Ö
eC:\Users\hp\Desktop\Role-Authentication\WebApplication1\WebApplication1\Controllers\HomeController.cs
	namespace 	
WebApplication1
 
. 
Controllers %
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
private		 
readonly		 
ILogger		  
<		  !
HomeController		! /
>		/ 0
_logger		1 8
;		8 9
public 
HomeController 
( 
ILogger %
<% &
HomeController& 4
>4 5
logger6 <
)< =
{ 	
_logger 
= 
logger 
; 
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Privacy $
($ %
)% &
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
ResponseCache	 
( 
Duration 
=  !
$num" #
,# $
Location% -
=. /!
ResponseCacheLocation0 E
.E F
NoneF J
,J K
NoStoreL S
=T U
trueV Z
)Z [
][ \
public 
IActionResult 
Error "
(" #
)# $
{ 	
return 
View 
( 
new 
ErrorViewModel *
{+ ,
	RequestId- 6
=7 8
Activity9 A
.A B
CurrentB I
?I J
.J K
IdK M
??N P
HttpContextQ \
.\ ]
TraceIdentifier] l
}m n
)n o
;o p
} 	
} 
}   º
\C:\Users\hp\Desktop\Role-Authentication\WebApplication1\WebApplication1\Data\AppDbContext.cs
	namespace 	
WebApplication1
 
. 
Data 
{ 
public 

class 
AppDbContext 
: 
IdentityDbContext /
</ 0
ApplicationUser0 ?
>? @
{ 
public 
AppDbContext 
( 
DbContextOptions ,
<, -
AppDbContext- 9
>9 :
options; B
)B C
:D E
baseF J
(J K
optionsK R
)R S
{		 	
} 	
} 
} û
_C:\Users\hp\Desktop\Role-Authentication\WebApplication1\WebApplication1\Data\ApplicationUser.cs
	namespace 	
WebApplication1
 
. 
Data 
{ 
public 

class 
ApplicationUser  
:! "
IdentityUser# /
{ 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 

PictureUrl !
{" #
get$ '
;' (
set) ,
;, -
}. /
}

 
} Ù
lC:\Users\hp\Desktop\Role-Authentication\WebApplication1\WebApplication1\Data\Services\IUserAuthentication.cs
	namespace 	
WebApplication1
 
. 
Data 
. 
Services '
{ 
public 

	interface 
IUserAuthentication (
{ 
public 
Task 
< 
Status 
> 

LoginAsync '
(' (

LoginModel( 2
model3 8
)8 9
;9 :
public 
Task 
LogoutAsync  
(  !
)! "
;" #
public		 
Task		 
<		 
Status		 
>		 
RegistrationAsync		 -
(		- .
RegistrationModel		. ?
model		@ E
)		E F
;		F G
} 
} ‘F
kC:\Users\hp\Desktop\Role-Authentication\WebApplication1\WebApplication1\Data\Services\UserAuthentication.cs
	namespace 	
WebApplication1
 
. 
Data 
. 
Services '
{ 
public		 

class		 
UserAuthentication		 #
:		$ %
IUserAuthentication		& 9
{

 
private 
readonly 
SignInManager &
<& '
ApplicationUser' 6
>6 7
_signInManager8 F
;F G
private 
readonly 
UserManager $
<$ %
ApplicationUser% 4
>4 5
_userManager6 B
;B C
private 
readonly 
RoleManager $
<$ %
IdentityRole% 1
>1 2
_roleManager3 ?
;? @
public 
UserAuthentication !
(! "
SignInManager" /
</ 0
ApplicationUser0 ?
>? @
signInManagerA N
,N O
UserManager 
< 
ApplicationUser '
>' (
userManager) 4
,4 5
RoleManager6 A
<A B
IdentityRoleB N
>N O
roleManagerP [
)[ \
{ 	
_signInManager 
= 
signInManager *
;* +
_userManager 
= 
userManager &
;& '
_roleManager 
= 
roleManager &
;& '
} 	
public 
async 
Task 
< 
Status  
>  !

LoginAsync" ,
(, -

LoginModel- 7
model8 =
)= >
{ 	
var 
search 
= 
await 
_userManager +
.+ ,
FindByEmailAsync, <
(< =
model= B
.B C
EmailC H
)H I
;I J
Status 
status 
= 
new 
Status  &
(& '
)' (
;( )
if 
( 
search 
== 
null 
) 
{ 
status 
. 

StatusCode !
=" #
$num$ %
;% &
status 
. 
Message 
=  
$str! 8
;8 9
return 
status 
; 
} 
if 
( 
! 
await 
_userManager "
." #
CheckPasswordAsync# 5
(5 6
search6 <
,< =
model= B
.B C
PasswordC K
)K L
)L M
{   
status!! 
.!! 

StatusCode!! !
=!!" #
$num!!$ %
;!!% &
status"" 
."" 
Message"" 
=""  
$str""! 8
;""8 9
return## 
status## 
;## 
}$$ 
var%% 
signInRequest%% 
=%% 
await%%  %
_signInManager%%& 4
.%%4 5
PasswordSignInAsync%%5 H
(%%H I
search%%I O
,%%O P
model%%Q V
.%%V W
Password%%W _
,%%_ `
true%%a e
,%%e f
true%%g k
)%%k l
;%%l m
if&& 
(&& 
signInRequest&& 
.&& 
	Succeeded&& &
)&&& '
{'' 
var(( 
	userRoles(( 
=(( 
await((  %
_userManager((& 2
.((2 3
GetUsersInRoleAsync((3 F
(((F G
search((G M
.((M N
ToString((N V
(((V W
)((W X
)((X Y
;((Y Z
var)) 

authClaims)) 
=))  
new))! $
List))% )
<))) *
Claim))* /
>))/ 0
{** 
new++ 
Claim++ 
(++ 

ClaimTypes++ (
.++( )
Name++) -
,++- .
search++/ 5
.++5 6
UserName++6 >
)++> ?
},, 
;,, 
foreach-- 
(-- 
var-- 
userRole-- $
in--% '
	userRoles--( 1
)--1 2
{.. 

authClaims// 
.// 
Add// "
(//" #
new//# &
Claim//' ,
(//, -
$str//- k
,//k l
userRole//m u
.//u v
Name//v z
)//z {
)//{ |
;//| }
}11 
status22 
.22 

StatusCode22 !
=22" #
$num22$ %
;22% &
status33 
.33 
Message33 
=33  
$str33! 1
;331 2
}44 
else55 
if55 
(55 
signInRequest55 !
.55! "
IsLockedOut55" -
)55- .
{66 
status77 
.77 

StatusCode77 !
=77" #
$num77$ %
;77% &
status88 
.88 
Message88 
=88  
$str88! 5
;885 6
}99 
else:: 
{;; 
status<< 
.<< 

StatusCode<< !
=<<" #
$num<<$ %
;<<% &
status== 
.== 
Message== 
===  
$str==! /
;==/ 0
}?? 
return@@ 
status@@ 
;@@ 
}AA 	
publicCC 
asyncCC 
TaskCC 
LogoutAsyncCC %
(CC% &
)CC& '
{DD 	
awaitEE 
_signInManagerEE  
.EE  !
SignOutAsyncEE! -
(EE- .
)EE. /
;EE/ 0
}GG 	
publicII 
asyncII 
TaskII 
<II 
StatusII  
>II  !
RegistrationAsyncII" 3
(II3 4
RegistrationModelII4 E
modelIIF K
)IIK L
{JJ 	
varKK 
statusKK 
=KK 
newKK 
StatusKK #
(KK# $
)KK$ %
;KK% &
varLL 
userLL 
=LL 
awaitLL 
_userManagerLL )
.LL) *
FindByNameAsyncLL* 9
(LL9 :
modelLL: ?
.LL? @
UserNameLL@ H
)LLH I
;LLI J
ifMM 
(MM 
userMM 
!=MM 
nullMM 
)MM 
{NN 
statusOO 
.OO 

StatusCodeOO !
=OO" #
$numOO$ %
;OO% &
statusPP 
.PP 
MessagePP 
=PP  
$strPP! 6
;PP6 7
returnQQ 
statusQQ 
;QQ 
}RR 
ApplicationUserSS 
applicationUserSS +
=SS, -
newSS. 1
ApplicationUserSS2 A
{TT 
UserNameUU 
=UU 
modelUU  
.UU  !
UserNameUU! )
,UU) *
EmailVV 
=VV 
modelVV 
.VV 
EmailVV #
,VV# $
SecurityStampWW 
=WW 
GuidWW  $
.WW$ %
NewGuidWW% ,
(WW, -
)WW- .
.WW. /
ToStringWW/ 7
(WW7 8
)WW8 9
,WW9 :
EmailConfirmedXX 
=XX  
trueXX! %
}YY 
;YY 
varZZ 
resultZZ 
=ZZ 
awaitZZ 
_userManagerZZ +
.ZZ+ ,
CreateAsyncZZ, 7
(ZZ7 8
applicationUserZZ8 G
,ZZG H
modelZZI N
.ZZN O
PasswordZZO W
)ZZW X
;ZZX Y
if[[ 
([[ 
![[ 
result[[ 
.[[ 
	Succeeded[[ !
)[[! "
{\\ 
status]] 
.]] 

StatusCode]] !
=]]" #
$num]]$ %
;]]% &
status^^ 
.^^ 
Message^^ 
=^^  
$str^^! 6
;^^6 7
return__ 
status__ 
;__ 
}`` 
ifaa 
(aa 
awaitaa 
_roleManageraa "
.aa" #
RoleExistsAsyncaa# 2
(aa2 3
modelaa3 8
.aa8 9
Roleaa9 =
)aa= >
)aa> ?
{bb 
awaitcc 
_userManagercc "
.cc" #
AddToRoleAsynccc# 1
(cc1 2
applicationUsercc2 A
,ccA B
modelccC H
.ccH I
RoleccI M
)ccM N
;ccN O
}dd 
statusee 
.ee 

StatusCodeee 
=ee 
$numee  !
;ee! "
statusff 
.ff 
Messageff 
=ff 
$strff 6
;ff6 7
returngg 
statusgg 
;gg 
}hh 	
}ii 
}jj · 
iC:\Users\hp\Desktop\Role-Authentication\WebApplication1\WebApplication1\Migrations\20230313075752_init.cs
	namespace 	
WebApplication1
 
. 

Migrations $
{ 
public		 

partial		 
class		 
init		 
:		 
	Migration		  )
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
string& ,
>, -
(- .
type. 2
:2 3
$str4 C
,C D
nullableE M
:M N
falseO T
)T U
,U V
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
	maxLengthG P
:P Q
$numR U
,U V
nullableW _
:_ `
truea e
)e f
,f g
NormalizedName "
=# $
table% *
.* +
Column+ 1
<1 2
string2 8
>8 9
(9 :
type: >
:> ?
$str@ O
,O P
	maxLengthQ Z
:Z [
$num\ _
,_ `
nullablea i
:i j
truek o
)o p
,p q
ConcurrencyStamp $
=% &
table' ,
., -
Column- 3
<3 4
string4 :
>: ;
(; <
type< @
:@ A
$strB Q
,Q R
nullableS [
:[ \
true] a
)a b
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 5
,5 6
x7 8
=>9 ;
x< =
.= >
Id> @
)@ A
;A B
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id   
=   
table   
.   
Column   %
<  % &
string  & ,
>  , -
(  - .
type  . 2
:  2 3
$str  4 C
,  C D
nullable  E M
:  M N
false  O T
)  T U
,  U V
Name!! 
=!! 
table!!  
.!!  !
Column!!! '
<!!' (
string!!( .
>!!. /
(!!/ 0
type!!0 4
:!!4 5
$str!!6 E
,!!E F
nullable!!G O
:!!O P
false!!Q V
)!!V W
,!!W X

PictureUrl"" 
=""  
table""! &
.""& '
Column""' -
<""- .
string"". 4
>""4 5
(""5 6
type""6 :
:"": ;
$str""< K
,""K L
nullable""M U
:""U V
false""W \
)""\ ]
,""] ^
UserName## 
=## 
table## $
.##$ %
Column##% +
<##+ ,
string##, 2
>##2 3
(##3 4
type##4 8
:##8 9
$str##: I
,##I J
	maxLength##K T
:##T U
$num##V Y
,##Y Z
nullable##[ c
:##c d
true##e i
)##i j
,##j k
NormalizedUserName$$ &
=$$' (
table$$) .
.$$. /
Column$$/ 5
<$$5 6
string$$6 <
>$$< =
($$= >
type$$> B
:$$B C
$str$$D S
,$$S T
	maxLength$$U ^
:$$^ _
$num$$` c
,$$c d
nullable$$e m
:$$m n
true$$o s
)$$s t
,$$t u
Email%% 
=%% 
table%% !
.%%! "
Column%%" (
<%%( )
string%%) /
>%%/ 0
(%%0 1
type%%1 5
:%%5 6
$str%%7 F
,%%F G
	maxLength%%H Q
:%%Q R
$num%%S V
,%%V W
nullable%%X `
:%%` a
true%%b f
)%%f g
,%%g h
NormalizedEmail&& #
=&&$ %
table&&& +
.&&+ ,
Column&&, 2
<&&2 3
string&&3 9
>&&9 :
(&&: ;
type&&; ?
:&&? @
$str&&A P
,&&P Q
	maxLength&&R [
:&&[ \
$num&&] `
,&&` a
nullable&&b j
:&&j k
true&&l p
)&&p q
,&&q r
EmailConfirmed'' "
=''# $
table''% *
.''* +
Column''+ 1
<''1 2
bool''2 6
>''6 7
(''7 8
type''8 <
:''< =
$str''> C
,''C D
nullable''E M
:''M N
false''O T
)''T U
,''U V
PasswordHash((  
=((! "
table((# (
.((( )
Column(() /
<((/ 0
string((0 6
>((6 7
(((7 8
type((8 <
:((< =
$str((> M
,((M N
nullable((O W
:((W X
true((Y ]
)((] ^
,((^ _
SecurityStamp)) !
=))" #
table))$ )
.))) *
Column))* 0
<))0 1
string))1 7
>))7 8
())8 9
type))9 =
:))= >
$str))? N
,))N O
nullable))P X
:))X Y
true))Z ^
)))^ _
,))_ `
ConcurrencyStamp** $
=**% &
table**' ,
.**, -
Column**- 3
<**3 4
string**4 :
>**: ;
(**; <
type**< @
:**@ A
$str**B Q
,**Q R
nullable**S [
:**[ \
true**] a
)**a b
,**b c
PhoneNumber++ 
=++  !
table++" '
.++' (
Column++( .
<++. /
string++/ 5
>++5 6
(++6 7
type++7 ;
:++; <
$str++= L
,++L M
nullable++N V
:++V W
true++X \
)++\ ]
,++] ^ 
PhoneNumberConfirmed,, (
=,,) *
table,,+ 0
.,,0 1
Column,,1 7
<,,7 8
bool,,8 <
>,,< =
(,,= >
type,,> B
:,,B C
$str,,D I
,,,I J
nullable,,K S
:,,S T
false,,U Z
),,Z [
,,,[ \
TwoFactorEnabled-- $
=--% &
table--' ,
.--, -
Column--- 3
<--3 4
bool--4 8
>--8 9
(--9 :
type--: >
:--> ?
$str--@ E
,--E F
nullable--G O
:--O P
false--Q V
)--V W
,--W X

LockoutEnd.. 
=..  
table..! &
...& '
Column..' -
<..- .
DateTimeOffset... <
>..< =
(..= >
type..> B
:..B C
$str..D T
,..T U
nullable..V ^
:..^ _
true..` d
)..d e
,..e f
LockoutEnabled// "
=//# $
table//% *
.//* +
Column//+ 1
<//1 2
bool//2 6
>//6 7
(//7 8
type//8 <
://< =
$str//> C
,//C D
nullable//E M
://M N
false//O T
)//T U
,//U V
AccessFailedCount00 %
=00& '
table00( -
.00- .
Column00. 4
<004 5
int005 8
>008 9
(009 :
type00: >
:00> ?
$str00@ E
,00E F
nullable00G O
:00O P
false00Q V
)00V W
}11 
,11 
constraints22 
:22 
table22 "
=>22# %
{33 
table44 
.44 

PrimaryKey44 $
(44$ %
$str44% 5
,445 6
x447 8
=>449 ;
x44< =
.44= >
Id44> @
)44@ A
;44A B
}55 
)55 
;55 
migrationBuilder77 
.77 
CreateTable77 (
(77( )
name88 
:88 
$str88 (
,88( )
columns99 
:99 
table99 
=>99 !
new99" %
{:: 
Id;; 
=;; 
table;; 
.;; 
Column;; %
<;;% &
int;;& )
>;;) *
(;;* +
type;;+ /
:;;/ 0
$str;;1 6
,;;6 7
nullable;;8 @
:;;@ A
false;;B G
);;G H
.<< 

Annotation<< #
(<<# $
$str<<$ 8
,<<8 9
$str<<: @
)<<@ A
,<<A B
RoleId== 
=== 
table== "
.==" #
Column==# )
<==) *
string==* 0
>==0 1
(==1 2
type==2 6
:==6 7
$str==8 G
,==G H
nullable==I Q
:==Q R
false==S X
)==X Y
,==Y Z
	ClaimType>> 
=>> 
table>>  %
.>>% &
Column>>& ,
<>>, -
string>>- 3
>>>3 4
(>>4 5
type>>5 9
:>>9 :
$str>>; J
,>>J K
nullable>>L T
:>>T U
true>>V Z
)>>Z [
,>>[ \

ClaimValue?? 
=??  
table??! &
.??& '
Column??' -
<??- .
string??. 4
>??4 5
(??5 6
type??6 :
:??: ;
$str??< K
,??K L
nullable??M U
:??U V
true??W [
)??[ \
}@@ 
,@@ 
constraintsAA 
:AA 
tableAA "
=>AA# %
{BB 
tableCC 
.CC 

PrimaryKeyCC $
(CC$ %
$strCC% :
,CC: ;
xCC< =
=>CC> @
xCCA B
.CCB C
IdCCC E
)CCE F
;CCF G
tableDD 
.DD 

ForeignKeyDD $
(DD$ %
nameEE 
:EE 
$strEE F
,EEF G
columnFF 
:FF 
xFF  !
=>FF" $
xFF% &
.FF& '
RoleIdFF' -
,FF- .
principalTableGG &
:GG& '
$strGG( 5
,GG5 6
principalColumnHH '
:HH' (
$strHH) -
,HH- .
onDeleteII  
:II  !
ReferentialActionII" 3
.II3 4
CascadeII4 ;
)II; <
;II< =
}JJ 
)JJ 
;JJ 
migrationBuilderLL 
.LL 
CreateTableLL (
(LL( )
nameMM 
:MM 
$strMM (
,MM( )
columnsNN 
:NN 
tableNN 
=>NN !
newNN" %
{OO 
IdPP 
=PP 
tablePP 
.PP 
ColumnPP %
<PP% &
intPP& )
>PP) *
(PP* +
typePP+ /
:PP/ 0
$strPP1 6
,PP6 7
nullablePP8 @
:PP@ A
falsePPB G
)PPG H
.QQ 

AnnotationQQ #
(QQ# $
$strQQ$ 8
,QQ8 9
$strQQ: @
)QQ@ A
,QQA B
UserIdRR 
=RR 
tableRR "
.RR" #
ColumnRR# )
<RR) *
stringRR* 0
>RR0 1
(RR1 2
typeRR2 6
:RR6 7
$strRR8 G
,RRG H
nullableRRI Q
:RRQ R
falseRRS X
)RRX Y
,RRY Z
	ClaimTypeSS 
=SS 
tableSS  %
.SS% &
ColumnSS& ,
<SS, -
stringSS- 3
>SS3 4
(SS4 5
typeSS5 9
:SS9 :
$strSS; J
,SSJ K
nullableSSL T
:SST U
trueSSV Z
)SSZ [
,SS[ \

ClaimValueTT 
=TT  
tableTT! &
.TT& '
ColumnTT' -
<TT- .
stringTT. 4
>TT4 5
(TT5 6
typeTT6 :
:TT: ;
$strTT< K
,TTK L
nullableTTM U
:TTU V
trueTTW [
)TT[ \
}UU 
,UU 
constraintsVV 
:VV 
tableVV "
=>VV# %
{WW 
tableXX 
.XX 

PrimaryKeyXX $
(XX$ %
$strXX% :
,XX: ;
xXX< =
=>XX> @
xXXA B
.XXB C
IdXXC E
)XXE F
;XXF G
tableYY 
.YY 

ForeignKeyYY $
(YY$ %
nameZZ 
:ZZ 
$strZZ F
,ZZF G
column[[ 
:[[ 
x[[  !
=>[[" $
x[[% &
.[[& '
UserId[[' -
,[[- .
principalTable\\ &
:\\& '
$str\\( 5
,\\5 6
principalColumn]] '
:]]' (
$str]]) -
,]]- .
onDelete^^  
:^^  !
ReferentialAction^^" 3
.^^3 4
Cascade^^4 ;
)^^; <
;^^< =
}__ 
)__ 
;__ 
migrationBuilderaa 
.aa 
CreateTableaa (
(aa( )
namebb 
:bb 
$strbb (
,bb( )
columnscc 
:cc 
tablecc 
=>cc !
newcc" %
{dd 
LoginProvideree !
=ee" #
tableee$ )
.ee) *
Columnee* 0
<ee0 1
stringee1 7
>ee7 8
(ee8 9
typeee9 =
:ee= >
$stree? N
,eeN O
nullableeeP X
:eeX Y
falseeeZ _
)ee_ `
,ee` a
ProviderKeyff 
=ff  !
tableff" '
.ff' (
Columnff( .
<ff. /
stringff/ 5
>ff5 6
(ff6 7
typeff7 ;
:ff; <
$strff= L
,ffL M
nullableffN V
:ffV W
falseffX ]
)ff] ^
,ff^ _
ProviderDisplayNamegg '
=gg( )
tablegg* /
.gg/ 0
Columngg0 6
<gg6 7
stringgg7 =
>gg= >
(gg> ?
typegg? C
:ggC D
$strggE T
,ggT U
nullableggV ^
:gg^ _
truegg` d
)ggd e
,gge f
UserIdhh 
=hh 
tablehh "
.hh" #
Columnhh# )
<hh) *
stringhh* 0
>hh0 1
(hh1 2
typehh2 6
:hh6 7
$strhh8 G
,hhG H
nullablehhI Q
:hhQ R
falsehhS X
)hhX Y
}ii 
,ii 
constraintsjj 
:jj 
tablejj "
=>jj# %
{kk 
tablell 
.ll 

PrimaryKeyll $
(ll$ %
$strll% :
,ll: ;
xll< =
=>ll> @
newllA D
{llE F
xllG H
.llH I
LoginProviderllI V
,llV W
xllX Y
.llY Z
ProviderKeyllZ e
}llf g
)llg h
;llh i
tablemm 
.mm 

ForeignKeymm $
(mm$ %
namenn 
:nn 
$strnn F
,nnF G
columnoo 
:oo 
xoo  !
=>oo" $
xoo% &
.oo& '
UserIdoo' -
,oo- .
principalTablepp &
:pp& '
$strpp( 5
,pp5 6
principalColumnqq '
:qq' (
$strqq) -
,qq- .
onDeleterr  
:rr  !
ReferentialActionrr" 3
.rr3 4
Cascaderr4 ;
)rr; <
;rr< =
}ss 
)ss 
;ss 
migrationBuilderuu 
.uu 
CreateTableuu (
(uu( )
namevv 
:vv 
$strvv '
,vv' (
columnsww 
:ww 
tableww 
=>ww !
newww" %
{xx 
UserIdyy 
=yy 
tableyy "
.yy" #
Columnyy# )
<yy) *
stringyy* 0
>yy0 1
(yy1 2
typeyy2 6
:yy6 7
$stryy8 G
,yyG H
nullableyyI Q
:yyQ R
falseyyS X
)yyX Y
,yyY Z
RoleIdzz 
=zz 
tablezz "
.zz" #
Columnzz# )
<zz) *
stringzz* 0
>zz0 1
(zz1 2
typezz2 6
:zz6 7
$strzz8 G
,zzG H
nullablezzI Q
:zzQ R
falsezzS X
)zzX Y
}{{ 
,{{ 
constraints|| 
:|| 
table|| "
=>||# %
{}} 
table~~ 
.~~ 

PrimaryKey~~ $
(~~$ %
$str~~% 9
,~~9 :
x~~; <
=>~~= ?
new~~@ C
{~~D E
x~~F G
.~~G H
UserId~~H N
,~~N O
x~~P Q
.~~Q R
RoleId~~R X
}~~Y Z
)~~Z [
;~~[ \
table 
. 

ForeignKey $
($ %
name
ÄÄ 
:
ÄÄ 
$str
ÄÄ E
,
ÄÄE F
column
ÅÅ 
:
ÅÅ 
x
ÅÅ  !
=>
ÅÅ" $
x
ÅÅ% &
.
ÅÅ& '
RoleId
ÅÅ' -
,
ÅÅ- .
principalTable
ÇÇ &
:
ÇÇ& '
$str
ÇÇ( 5
,
ÇÇ5 6
principalColumn
ÉÉ '
:
ÉÉ' (
$str
ÉÉ) -
,
ÉÉ- .
onDelete
ÑÑ  
:
ÑÑ  !
ReferentialAction
ÑÑ" 3
.
ÑÑ3 4
Cascade
ÑÑ4 ;
)
ÑÑ; <
;
ÑÑ< =
table
ÖÖ 
.
ÖÖ 

ForeignKey
ÖÖ $
(
ÖÖ$ %
name
ÜÜ 
:
ÜÜ 
$str
ÜÜ E
,
ÜÜE F
column
áá 
:
áá 
x
áá  !
=>
áá" $
x
áá% &
.
áá& '
UserId
áá' -
,
áá- .
principalTable
àà &
:
àà& '
$str
àà( 5
,
àà5 6
principalColumn
ââ '
:
ââ' (
$str
ââ) -
,
ââ- .
onDelete
ää  
:
ää  !
ReferentialAction
ää" 3
.
ää3 4
Cascade
ää4 ;
)
ää; <
;
ää< =
}
ãã 
)
ãã 
;
ãã 
migrationBuilder
çç 
.
çç 
CreateTable
çç (
(
çç( )
name
éé 
:
éé 
$str
éé (
,
éé( )
columns
èè 
:
èè 
table
èè 
=>
èè !
new
èè" %
{
êê 
UserId
ëë 
=
ëë 
table
ëë "
.
ëë" #
Column
ëë# )
<
ëë) *
string
ëë* 0
>
ëë0 1
(
ëë1 2
type
ëë2 6
:
ëë6 7
$str
ëë8 G
,
ëëG H
nullable
ëëI Q
:
ëëQ R
false
ëëS X
)
ëëX Y
,
ëëY Z
LoginProvider
íí !
=
íí" #
table
íí$ )
.
íí) *
Column
íí* 0
<
íí0 1
string
íí1 7
>
íí7 8
(
íí8 9
type
íí9 =
:
íí= >
$str
íí? N
,
ííN O
nullable
ííP X
:
ííX Y
false
ííZ _
)
íí_ `
,
íí` a
Name
ìì 
=
ìì 
table
ìì  
.
ìì  !
Column
ìì! '
<
ìì' (
string
ìì( .
>
ìì. /
(
ìì/ 0
type
ìì0 4
:
ìì4 5
$str
ìì6 E
,
ììE F
nullable
ììG O
:
ììO P
false
ììQ V
)
ììV W
,
ììW X
Value
îî 
=
îî 
table
îî !
.
îî! "
Column
îî" (
<
îî( )
string
îî) /
>
îî/ 0
(
îî0 1
type
îî1 5
:
îî5 6
$str
îî7 F
,
îîF G
nullable
îîH P
:
îîP Q
true
îîR V
)
îîV W
}
ïï 
,
ïï 
constraints
ññ 
:
ññ 
table
ññ "
=>
ññ# %
{
óó 
table
òò 
.
òò 

PrimaryKey
òò $
(
òò$ %
$str
òò% :
,
òò: ;
x
òò< =
=>
òò> @
new
òòA D
{
òòE F
x
òòG H
.
òòH I
UserId
òòI O
,
òòO P
x
òòQ R
.
òòR S
LoginProvider
òòS `
,
òò` a
x
òòb c
.
òòc d
Name
òòd h
}
òòi j
)
òòj k
;
òòk l
table
ôô 
.
ôô 

ForeignKey
ôô $
(
ôô$ %
name
öö 
:
öö 
$str
öö F
,
ööF G
column
õõ 
:
õõ 
x
õõ  !
=>
õõ" $
x
õõ% &
.
õõ& '
UserId
õõ' -
,
õõ- .
principalTable
úú &
:
úú& '
$str
úú( 5
,
úú5 6
principalColumn
ùù '
:
ùù' (
$str
ùù) -
,
ùù- .
onDelete
ûû  
:
ûû  !
ReferentialAction
ûû" 3
.
ûû3 4
Cascade
ûû4 ;
)
ûû; <
;
ûû< =
}
üü 
)
üü 
;
üü 
migrationBuilder
°° 
.
°° 
CreateIndex
°° (
(
°°( )
name
¢¢ 
:
¢¢ 
$str
¢¢ 2
,
¢¢2 3
table
££ 
:
££ 
$str
££ )
,
££) *
column
§§ 
:
§§ 
$str
§§  
)
§§  !
;
§§! "
migrationBuilder
¶¶ 
.
¶¶ 
CreateIndex
¶¶ (
(
¶¶( )
name
ßß 
:
ßß 
$str
ßß %
,
ßß% &
table
®® 
:
®® 
$str
®® $
,
®®$ %
column
©© 
:
©© 
$str
©© (
,
©©( )
unique
™™ 
:
™™ 
true
™™ 
,
™™ 
filter
´´ 
:
´´ 
$str
´´ 6
)
´´6 7
;
´´7 8
migrationBuilder
≠≠ 
.
≠≠ 
CreateIndex
≠≠ (
(
≠≠( )
name
ÆÆ 
:
ÆÆ 
$str
ÆÆ 2
,
ÆÆ2 3
table
ØØ 
:
ØØ 
$str
ØØ )
,
ØØ) *
column
∞∞ 
:
∞∞ 
$str
∞∞  
)
∞∞  !
;
∞∞! "
migrationBuilder
≤≤ 
.
≤≤ 
CreateIndex
≤≤ (
(
≤≤( )
name
≥≥ 
:
≥≥ 
$str
≥≥ 2
,
≥≥2 3
table
¥¥ 
:
¥¥ 
$str
¥¥ )
,
¥¥) *
column
µµ 
:
µµ 
$str
µµ  
)
µµ  !
;
µµ! "
migrationBuilder
∑∑ 
.
∑∑ 
CreateIndex
∑∑ (
(
∑∑( )
name
∏∏ 
:
∏∏ 
$str
∏∏ 1
,
∏∏1 2
table
ππ 
:
ππ 
$str
ππ (
,
ππ( )
column
∫∫ 
:
∫∫ 
$str
∫∫  
)
∫∫  !
;
∫∫! "
migrationBuilder
ºº 
.
ºº 
CreateIndex
ºº (
(
ºº( )
name
ΩΩ 
:
ΩΩ 
$str
ΩΩ "
,
ΩΩ" #
table
ææ 
:
ææ 
$str
ææ $
,
ææ$ %
column
øø 
:
øø 
$str
øø )
)
øø) *
;
øø* +
migrationBuilder
¡¡ 
.
¡¡ 
CreateIndex
¡¡ (
(
¡¡( )
name
¬¬ 
:
¬¬ 
$str
¬¬ %
,
¬¬% &
table
√√ 
:
√√ 
$str
√√ $
,
√√$ %
column
ƒƒ 
:
ƒƒ 
$str
ƒƒ ,
,
ƒƒ, -
unique
≈≈ 
:
≈≈ 
true
≈≈ 
,
≈≈ 
filter
∆∆ 
:
∆∆ 
$str
∆∆ :
)
∆∆: ;
;
∆∆; <
}
«« 	
	protected
   
override
   
void
   
Down
    $
(
  $ %
MigrationBuilder
  % 5
migrationBuilder
  6 F
)
  F G
{
ÀÀ 	
migrationBuilder
ÃÃ 
.
ÃÃ 
	DropTable
ÃÃ &
(
ÃÃ& '
name
ÕÕ 
:
ÕÕ 
$str
ÕÕ (
)
ÕÕ( )
;
ÕÕ) *
migrationBuilder
œœ 
.
œœ 
	DropTable
œœ &
(
œœ& '
name
–– 
:
–– 
$str
–– (
)
––( )
;
––) *
migrationBuilder
““ 
.
““ 
	DropTable
““ &
(
““& '
name
”” 
:
”” 
$str
”” (
)
””( )
;
””) *
migrationBuilder
’’ 
.
’’ 
	DropTable
’’ &
(
’’& '
name
÷÷ 
:
÷÷ 
$str
÷÷ '
)
÷÷' (
;
÷÷( )
migrationBuilder
ÿÿ 
.
ÿÿ 
	DropTable
ÿÿ &
(
ÿÿ& '
name
ŸŸ 
:
ŸŸ 
$str
ŸŸ (
)
ŸŸ( )
;
ŸŸ) *
migrationBuilder
€€ 
.
€€ 
	DropTable
€€ &
(
€€& '
name
‹‹ 
:
‹‹ 
$str
‹‹ #
)
‹‹# $
;
‹‹$ %
migrationBuilder
ﬁﬁ 
.
ﬁﬁ 
	DropTable
ﬁﬁ &
(
ﬁﬁ& '
name
ﬂﬂ 
:
ﬂﬂ 
$str
ﬂﬂ #
)
ﬂﬂ# $
;
ﬂﬂ$ %
}
‡‡ 	
}
·· 
}‚‚ ¿
`C:\Users\hp\Desktop\Role-Authentication\WebApplication1\WebApplication1\Models\ErrorViewModel.cs
	namespace 	
WebApplication1
 
. 
Models  
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 —
\C:\Users\hp\Desktop\Role-Authentication\WebApplication1\WebApplication1\Models\LoginModel.cs
	namespace 	
WebApplication1
 
. 
Models  
{ 
public 

class 

LoginModel 
{ 
[ 	
Required	 
] 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
[		 	
Required			 
]		 
[

 	
StringLength

	 
(

 
$num

 
,

 
ErrorMessage

 '
=

( )
$str

* H
,

H I
MinimumLength

J W
=

X Y
$num

Z [
)

[ \
]

\ ]
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ﬂ
cC:\Users\hp\Desktop\Role-Authentication\WebApplication1\WebApplication1\Models\RegistrationModel.cs
	namespace 	
WebApplication1
 
. 
Models  
{ 
public 

class 
RegistrationModel "
{ 
[ 	
Required	 
] 
public		 
string		 
Name		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
[

 	
Required

	 
]

 
public 
string 
UserName 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
] 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Required	 
] 
[ 	
StringLength	 
( 
$num 
, 
ErrorMessage '
=( )
$str* H
,H I
MinimumLengthJ W
=X Y
$numZ [
)[ \
]\ ]
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
] 
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
[ 	
Compare	 
( 
$str 
) 
] 
public 
string  
PasswordConfirmation *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
string 
Role 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ÿ
XC:\Users\hp\Desktop\Role-Authentication\WebApplication1\WebApplication1\Models\Status.cs
	namespace 	
WebApplication1
 
. 
Models  
{ 
public 

class 
Status 
{ 
public 
int 

StatusCode 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Message 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} ˙
RC:\Users\hp\Desktop\Role-Authentication\WebApplication1\WebApplication1\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder		 
.		 
Services		 
.		 #
AddControllersWithViews		 (
(		( )
)		) *
;		* +
builder

 
.

 
Services

 
.

 
AddDbContext

 
<

 
AppDbContext

 *
>

* +
(

+ ,
options

, 3
=>

4 6
options

7 >
.

> ?
UseSqlServer

? K
(

K L
builder 
. 
Configuration 
. 
GetConnectionString -
(- .
$str. A
)A B
) 
) 
; 
builder 
. 
Services 
. 
AddIdentity 
< 
ApplicationUser ,
,, -
IdentityRole. :
>: ;
(; <
)< =
. $
AddEntityFrameworkStores 
< 
AppDbContext &
>& '
(' (
)( )
. $
AddDefaultTokenProviders 
( 
) 
; 
builder 
. 
Services 
. &
ConfigureApplicationCookie +
(+ ,
op, .
=>/ 1
op2 4
.4 5
	LoginPath5 >
=? @
$strA [
)[ \
;\ ]
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
! 
app 
. 	
Environment	 
. 
IsDevelopment "
(" #
)# $
)$ %
{ 
app 
. 
UseExceptionHandler 
( 
$str )
)) *
;* +
app 
. 
UseHsts 
( 
) 
; 
} 
app 
. 
UseHttpsRedirection 
( 
) 
; 
app 
. 
UseStaticFiles 
( 
) 
; 
app 
. 

UseRouting 
( 
) 
; 
app 
. 
UseAuthentication 
( 
) 
; 
app   
.   
UseAuthorization   
(   
)   
;   
app"" 
."" 
MapControllerRoute"" 
("" 
name## 
:## 	
$str##
 
,## 
pattern$$ 
:$$ 
$str$$ 5
)$$5 6
;$$6 7
app&& 
.&& 
Run&& 
(&& 
)&& 	
;&&	 
